---
import { getCollection, getEntry } from "astro:content";

import Grid from "@/components/Grid.astro";
import Hero from "@/components/Hero.astro";
import Layout from "@/layouts/Layout.astro";

import Story from "../components/RichText.astro";

const home = await getCollection("home");
const hero = home.find(({ slug }) => slug === "hero")?.data;
const grid = home.find(({ slug }) => slug === "grid")?.data;
const richText = await getEntry("home", "richtext");
const content = (richText as unknown as { rendered: { html: string } }).rendered
  .html;
---

<Layout title="Astro demo - Home" description="This is the home page">
  {hero && <Hero {...hero} />}
  {grid && <Grid {...grid} />}
  {
    richText && (
      <Story>
        <div set:html={content} />
      </Story>
    )
  }
</Layout>
